<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>sdl-srch-grid demo</title>
    <script type="module" src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script>
    <script type="module" src="../src/components/sdl-srch-grid.js"></script>
    <script type="module">
      import '@polymer/iron-demo-helpers/demo-pages-shared-styles.js';
      import '@polymer/iron-demo-helpers/demo-snippet.js';
      import '@polymer/paper-input/paper-input.js';
      import '@polymer/iron-pages/iron-pages.js';
      import '@polymer/iron-icons/iron-icons.js';
      import '@vaadin/vaadin-tabs/vaadin-tabs.js';
    </script>

    <custom-style>
      <style is="custom-style" include="demo-pages-shared-styles">
        .details {
          display: flex;
          font-size: 20px;
        }

        .active {
          opacity: 1
        }

        .inactive {
          opacity: .05
        }

        img {
          width: 80px;
          height: 80px;
          margin: 20px;
        }
      </style>
      
    </custom-style>
  </head>
  <body>

    <vaadin-tabs id="tabs" selected="0">
    <vaadin-tab>Basic Usage w slots</vaadin-tab>
    <vaadin-tab>Select Column</vaadin-tab>
    <vaadin-tab>70,000 Records!</vaadin-tab>
    <vaadin-tab>Tree View</vaadin-tab>
    <vaadin-tab>Editable Grid</vaadin-tab>
    <!-- <vaadin-tab>Google like</vaadin-tab> -->
  </vaadin-tabs>

  <iron-pages id="pages">

    <div class="vertical-section-container centered">
      <h1>Basic sdl-srch-grid demo (using slots)</h1>
      <p><u>Note: Type in search field to generate ajax call(s) to server.</u>  
        Notice you can use any input type fields in the slot as well as any formatting you wish.  We are using txt files for the ajax so don't be worried about the filtering not working;)</p>
      <demo-snippet>
        <template>         

<!-- If using as a stand-alone-component:  use sdl-srch-grid-loader.js
<script src="./node_modules/@sdl-web/sdl-srch-grid/build-component/sdl-srch-grid-loader.js"></script> -->

<!-- If using in an existing polymer project:  use sdl-srch-grid.js directly-->
<!-- <script type="import" src="@sdl-web/sdl-srch-grid/src/components/sdl-srch-grid.js"></script>  -->

<!-- Now add sdl-srch-grid to html section -->
<sdl-srch-grid id='srch-grid' url='./data/srch-data-8000.txt'>  

  <!-- Put whatever input fields (and styling) you want into 'search-slot' -->
  <form slot="search-slot">
    <paper-input name="input1" label="Filter Search">
      <iron-icon icon="search" id="srch-icon" slot="prefix"></iron-icon>
    </paper-input>
    Show Active <input type="checkbox" name="active"></input>
  </form>

  <!-- Add the vaadin-grid into the 'grid-slot' -->
  <vaadin-grid slot="grid-slot">
    <vaadin-grid-column>
      <template class="header">Name</template>
      <template>[[item.name]]</template>
    </vaadin-grid-column>
    <vaadin-grid-column>
      <template class="header"><vaadin-grid-sorter path="gender">Gender</vaadin-grid-sorter></template>
      <template>[[item.gender]]</template>
    </vaadin-grid-column>
    <vaadin-grid-column>
      <template class="header">Eye Color</template>
      <template>[[item.eyeColor]]</template>
    </vaadin-grid-column>  
  </vaadin-grid>  

</sdl-srch-grid>

        </template>
      </demo-snippet>
    </div>

    <div class="vertical-section-container centered">
        <h1>Adding in a Selection Column with row-stripes</h1>
        <demo-snippet>
          <template>         
  
  <!-- If using as a stand-alone-component:  use sdl-srch-grid-loader.js
  <script src="./node_modules/@sdl-web/sdl-srch-grid/build-component/sdl-srch-grid-loader.js"></script> -->
  
  <!-- If using in an existing polymer project:  use sdl-srch-grid.js directly-->
  <!-- <script type="import" src="@sdl-web/sdl-srch-grid/src/components/sdl-srch-grid.js"></script>  -->
  
  <!-- Now add sdl-srch-grid to html section -->
  <sdl-srch-grid id='srch-grid' url='./data/srch-data-8000.txt'>  
  
    <!-- Put whatever input fields (and styling) you want into 'search-slot' -->
    <form slot="search-slot">
      <paper-input name="input1" label="Filter Search">
        <iron-icon icon="search" id="srch-icon" slot="prefix"></iron-icon>
      </paper-input>
    </form>
  
    <!-- Add the vaadin-grid into the 'grid-slot' -->
    <vaadin-grid theme='row-stripes' slot="grid-slot">
      <vaadin-grid-selection-column auto-select> </vaadin-grid-selection-column>
      <vaadin-grid-column>
        <template class="header">Name</template>
        <template>[[item.name]]</template>
      </vaadin-grid-column>
      <vaadin-grid-column>
        <template class="header"><vaadin-grid-sorter path="gender">Gender</vaadin-grid-sorter></template>
        <template>[[item.gender]]</template>
      </vaadin-grid-column>
      <vaadin-grid-column>
        <template class="header">Eye Color</template>
        <template>[[item.eyeColor]]</template>
      </vaadin-grid-column>     
    </vaadin-grid>
  </sdl-srch-grid>
  
          </template>
        </demo-snippet>
      </div>

    <div class="vertical-section-container centered">
        <h1>Smooth scrooling with 70,000 records!</h1>
      <demo-snippet>
        <template>         

<!-- Now add sdl-srch-grid to html section -->
<sdl-srch-grid id='srch-grid' url='./data/srch-data-70000.txt'>  

  <!-- Put whatever input fields (and styling) you want into 'search-slot' -->
  <form slot="search-slot">
    <paper-input name="input1" label="Filter Search">
      <iron-icon icon="search" id="srch-icon" slot="prefix"></iron-icon>
    </paper-input>
  </form>

  <!-- Add the vaadin-grid into the 'grid-slot' -->
  <vaadin-grid slot="grid-slot">
    <vaadin-grid-column  >
      <template class="header">Id</template>
      <template>[[item._id]]</template>
    </vaadin-grid-column>
    <vaadin-grid-column  >
      <template class="header">Name</template>
      <template>[[item.name]]</template>
    </vaadin-grid-column>
    <vaadin-grid-column  >
      <template class="header"><vaadin-grid-sorter path="gender">Gender</vaadin-grid-sorter></template>
      <template>[[item.gender]]</template>
    </vaadin-grid-column>
    <vaadin-grid-column  >
      <template class="header">Eye Color</template>
      <template>[[item.eyeColor]]</template>
    </vaadin-grid-column>   
  </vaadin-grid>  

</sdl-srch-grid>

        </template>
      </demo-snippet>
    </div>


    <div class="vertical-section-container centered">
        <h1>Tree View using 'expandall' flag</h1>
      <demo-snippet>
        <template>         

<!-- Now add sdl-srch-grid to html section -->
<sdl-srch-grid id='srch-grid'  url='./data/srch-data-tree.txt' expandall>  

  <!-- Put whatever input fields (and styling) you want into 'search-slot' -->
  <form slot="search-slot">
    <paper-input name="input1" label="Filter Search">
      <iron-icon icon="search" id="srch-icon" slot="prefix"></iron-icon>
    </paper-input>
  </form>

  <!-- Add the vaadin-grid into the 'grid-slot' -->
  <vaadin-grid slot="grid-slot">
    <vaadin-grid-column  >
      <template class="header">Name</template>
          <template>
            <vaadin-grid-tree-toggle leaf="[[!item.hasChildren]]" expanded="{{expanded}}" level="[[level]]">
              [[item.name]]
            </vaadin-grid-tree-toggle>
          </template>
    </vaadin-grid-column>
    <vaadin-grid-column  >
      <template class="header">Gender</template>
      <template>[[item.gender]]</template>
    </vaadin-grid-column>
    <vaadin-grid-column  >
      <template class="header">Eye Color</template>
      <template>[[item.eyeColor]]</template>
    </vaadin-grid-column>     
  </vaadin-grid>

</sdl-srch-grid>

        </template>
      </demo-snippet>
    </div>
    <div class="vertical-section-container centered">
      <h1>Editable grid Example</h1>
      <u>Note: Button clicks are intercepted in the 'grid-slot' and new events thrown to allow implementation of CRUD operations</u>  
        <b>Events thrown:</b>   
          <ul>
            <li>sdl-srch-grid-add</li>
            <li>sdl-srch-grid-edit</li>
            <li>sdl-srch-grid-delete</li>
            <li>sdl-srch-grid-custom</li>
            <li>sdl-srch-grid-mouseover</li>
            <li>sdl-srch-grid-mouseout</li>
          </ul>
    <demo-snippet>
      <template>         

<!-- Now add sdl-srch-grid to html section -->
<sdl-srch-grid id='srch-grid99' url='./data/srch-data-8000.txt'>  

<!-- Put whatever input fields (and styling) you want into 'search-slot' -->
<form slot="search-slot">
  <paper-input name="input1" label="Filter Search">
    <iron-icon icon="search" id="srch-icon" slot="prefix"></iron-icon>
  </paper-input>
</form>

  <!-- Add the vaadin-grid into the 'grid-slot' -->
<vaadin-grid slot="grid-slot">
  <vaadin-grid-column>
    <template class="header">Id</template>
    <template style="height:200px">[[item._id]]</template>
  </vaadin-grid-column>
  <vaadin-grid-column  >
    <template class="header">Name</template>
    <template>[[item.name]]</template>
  </vaadin-grid-column>
  <vaadin-grid-column  >
    <template class="header"><vaadin-grid-sorter path="gender">Gender</vaadin-grid-sorter></template>
    <template>[[item.gender]]</template>
  </vaadin-grid-column>
  <vaadin-grid-column  >
    <template class="header">Eye Color</template>
    <template>[[item.eyeColor]]</template>
  </vaadin-grid-column>    
  <vaadin-grid-column>
    <template class="header">
            <!-- Note:  the id of an ADD button must start with 'add-'  -->
            <vaadin-button id="add-button" theme="primary" aria-label="Add">Add</vaadin-button>
    </template> 
    <template>
        <!-- Note:  the id of an EDIT button must start with 'edit-{any characters}-{_id of the record}'  -->
        <vaadin-button id="edit-button-[[item._id]]"  class="inactive" theme="icon"><iron-icon icon="icons:create" slot="prefix"></iron-icon></vaadin-button>
          <!-- Note:  the id of an DELETE button must start with 'delete-{any characters}-{_id of the record}'  -->
        <vaadin-button id="delete-button-[[item._id]]"  class="inactive" theme="icon"><iron-icon icon="icons:clear" slot="prefix"></iron-icon></vaadin-button>
    </template>
  </vaadin-grid-column>  
</vaadin-grid>

</sdl-srch-grid>

<script>

// Note:  Listen for events from sdl-srch-grid to do Insert, Update & Delete
addEventListener('sdl-srch-grid-edit', function(e) {
  var grid = document.getElementById('srch-grid99');

  // Bring up your own form window here to allow user to UPDATE a record.   
  // On successful UPDATE to DB --  call grid.updateRecord() to update the grid.
  e.detail.formData.name = "XXXX";
  grid.updateRecord(e.detail.formData);
  console.log("EDIT=",e);
});

addEventListener('sdl-srch-grid-add', function(e) {
  var grid = document.getElementById('srch-grid99');

  // Bring up your own INSERT window here to allow user to insert a record  
  // On successful INSERT to DB --  call grid.insertRecord() to update the grid.
  var rec = {_id: "99", name:"INSERT", gender: "ZZZ", eyeColor: "Blue"};
  grid.insertRecord(rec);
  console.log("ADD=",e);
});

addEventListener('sdl-srch-grid-delete', function(e) {
  var grid = document.getElementById('srch-grid99');

  // Optionally, you could bring up a "Are You Sure?" dialog before doing your own ajax call to delete the record
  // then call grid.deleteRecord() to update the grid.
  grid.deleteRecord(e.detail.formData);
  console.log("DELETE=",e);
});

addEventListener('sdl-srch-grid-custom', function(e) {

  // If you add a button that does not follow the button id naming convention of "add-", "edit-" or "delete-"
  // Then the 'sdl-srch-grid-custom event will be thrown.  
  // You will be able to deal with your custom button here.
  // Note:  e.detail.formData will be filled in if you put the record _id at the end of your id name.
  console.log("CUSTOM=",e);
});

addEventListener('sdl-srch-grid-mouseover', function(e) {
  var grid = document.getElementById('srch-grid99');

  var buttons = grid.querySelectorAll(".active");
  for(var i=0; i < buttons.length; i++) {
    buttons[i].classList.remove('active');
    buttons[i].classList.add('inactive');
  }

  if (typeof e.detail.formData != 'undefined' && typeof e.detail.formData._id != 'undefined') {
    var editBtn = document.getElementById("edit-button-"+e.detail.formData._id);
    var delBtn = document.getElementById("delete-button-"+e.detail.formData._id);
    editBtn.classList.remove("inactive");
    delBtn.classList.remove("inactive");
    editBtn.classList.add("active");
    delBtn.classList.add("active");
  }
});

addEventListener('sdl-srch-grid-mouseout', function(e) {
  var grid = document.getElementById('srch-grid99');

  if (typeof e.detail.formData != 'undefined' && typeof e.detail.formData._id != 'udefined') {
    var editBtn = document.getElementById("edit-button-"+e.detail.formData._id);
    var delBtn = document.getElementById("delete-button-"+e.detail.formData._id);
    editBtn.classList.remove("active");
    delBtn.classList.remove("active");
    editBtn.classList.add("inactive");
    delBtn.classList.add("inactive");
  }
});
</script>

      </template>
    </demo-snippet>
  </div>
</iron-pages> 


    <script>



    addEventListener('DOMContentLoaded', function(){ 
      console.log("Srch Grid Loaded...");
      var tabs = document.getElementById('tabs');
      var pages = document.getElementById('pages');
      tabs.addEventListener('click', function(e,b,c) {
        setTimeout(function(){ 
          pages.selected = tabs.selected;
        }, 100);
      });
      pages.selected = 0;

    });
    </script>
  </body>
</html>
